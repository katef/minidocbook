
% https://eegg.wordpress.com/2010/01/25/page-margins-in-principle-and-practice/
% single page canon
% works for most ratios except 1:1, which looks odd

\startenvironment doublecircle

	\startMPdefinitions
		vardef canon(expr h, w) =
			path p, q;
			path a, b;
			path c, d, e, f;
			pair r[];

			% TODO: move each circle into its own macro

			p := (0, 0) -- (w, h);
			q := (w, 0) -- (0, h);

			a := (0, .5h + .5w) -- (w, .5h + .5w); % top
			b := (0, .5h - .5w) -- (w, .5h - .5w); % bottom

			c = fullcircle scaled w shifted (.5w, h - .5w); % top
			d = fullcircle scaled w shifted (.5w, 0 + .5w); % bottom

			e = subpath (0, 4) of c; % top arc
			f = subpath (4, 8) of d; % bottom arc

			draw p withcolor blue;
			draw q withcolor blue;

			draw c withcolor blue;
			draw d withcolor blue;

			r0 = q intersectionpoint e; % top left
			r1 = p intersectionpoint e; % top right
			r2 = q intersectionpoint f; % bottom right
			r3 = p intersectionpoint f; % bottom left

			r
		enddef;
	\stopMPdefinitions

\stopenvironment

